<!DOCTYPE html>
<html lang="it-IT">
<head>
    <title>{% block title %} Liquimet S.r.l. {% endblock %}</title>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link href="/css/styles.css" type="text/css" rel="stylesheet" />

    {# Bootstrap CSS (latest stable) #} 
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" 
        integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">

    {# Font Awesome & Bootstrap Icons #}
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    {# Google Fonts (Rubik) #}
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400&display=swap" rel="stylesheet">
    {% block head %}{% endblock %}  
</head>

{% block body %}
<body class="d-flex flex-column">
    <header id="header" class="container-fluid header d-flex mx-auto">

       <button class="navbar-toggler d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileMenu" aria-controls="mobileMenu">
            <span class="navbar-toggler-icon"></span>
        </button>
        
        {# Logo #}
        <div class="d-flex align-items-center my-auto div-title">
            <a href="/{% if session.role == 'admin' %}admin/dashboard{% else %}index{% endif %}" 
                class="d-flex align-items-center logo">

                <img src="/img/liquimet_logo.jpg" class="px-1 img-logo" alt="Liquimet Logo">
                    <h3 class="d-none d-lg-block px-2 my-auto" id="layout-title">
                        Liquimet Padova 
                    </h3>   
            </a>
        </div>

        {# Search Bar #}
        {% block search %}
            <section class="row my-auto mx-auto px-3 search-header">
                <div class="my-auto m-0 search-bar"></div>
            </section>
        {% endblock %}
    
        {# Navigation Bar #}
        <nav>
            <div class="container-fluid px-3">
                <div class="overflow-auto">
                    <ul class="nav nav-tabs-bordered flex-nowrap flex-row align-items-center gap-2 mb-0" style="min-width: max-content; overflow: visible;">
                        
                        {# Index #} 
                        <li class="nav-item nav-fill text-center mx-1">
                            <a class="nav-link" href="/{% if session.role == 'admin' %}admin/dashboard{% else %}index{% endif %}">
                                <i class="bi bi-house"></i>
                            </a>
                        </li>

                        {# Separator #}
                        <li class="nav-item">
                            <i class="bi bi-chevron-double-right" style="color: #0066cc"></i>
                        </li>

                        {# Platform #}
                        <li class="nav-item nav-fill text-center mx-1">
                            <a class="nav-link" href="/platform">Piattaforma</a>
                        </li>

                        {% if session.role == 'admin' %}
                            {# Separator #}
                            <li>
                                <i class="bi bi-chevron-double-right" style="color: #0066cc"></i>
                            </li>

                            {# Users #}
                            <li class="nav-item nav-fill text-center mx-1">
                                <a class="nav-link" href="/admin/users">Utenti</a>
                            </li>
                        {% endif %}
                    </ul>
                </div>
            </div>
        </nav>
        {# End Navigation Bar #}

        {# Browse Bar #}
        {% block browse %}
            <section class="row my-auto mx-auto px-3 browse-header">
                <div class="my-auto m-0 browse-bar"></div>
            </section>
        {% endblock %}

        {# Logged User Profile #}
        <nav class="header-nav mx-3 p-2">
            <ul class="d-flex align-items-center justify-content-end my-auto">

                {# Profile Icon #}                                                        
                <li class="nav-item dropdown d-flex justify-content-end my-auto">
                    <a class="nav-link p-1 my-auto mx-1 nav-profile" data-bs-toggle="dropdown" id="nav-profile" aria-expanded="false">
                        <span class="d-none d-md-block dropdown-toggle px-1"> {{ session.username }} </span>
                    </a>  

                    {# Profile Dropdown Menu #}   
                    <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow profile">
                        <li class="dropdown-header">
                            <h5> {{ session.name|upper }} </h5>
                                <span> {{ session.role|capitalize }} </span>
                        </li>
            
                        <li>
                            <hr class="dropdown-divider">
                        </li>

                        <li>
                            <a class="dropdown-item d-flex justify-content-center" href="/profile">
                                <span> Profilo </span>
                            </a>
                        </li>
            
                        <li>
                            <hr class="dropdown-divider">
                        </li>

                        {% if session.role == 'admin' %}
                            <li>
                                <a class="dropdown-item d-flex justify-content-center" href="/admin/login-audit">
                                    <span> Revisione accesso utenti </span>
                                </a>
                            </li>
                        {% endif %}

                        <li>
                            <hr class="dropdown-divider">
                        </li>

                        <li>
                            <a class="dropdown-item d-flex justify-content-center" href="/logout">
                                <span> Esci </span>
                            </a>
                        </li>    
                    </ul>  
                    {# End Profile Dropdown Menu #} 
                    
                </li>               
            </ul>
        </nav>                   
    </header> 

    <!-- Mobile Sidebar Menu -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="mobileMenu">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title">Menu</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body">
            <ul class="nav flex-column">
                <li class="nav-item"><a class="nav-link" href="/{% if session.access == 'admin' %}admin/dashboard{% else %}index{% endif %}">Home</a></li>
                <li class="nav-item"><a class="nav-link" href="#">Tables</a></li>
                {% if session.access == 'admin' %}
                    <li class="nav-item"><a class="nav-link" href="#">Companies</a></li>
                {% endif %}
            </ul>
        </div>
    </div>

    <main>
        {% block content %}{% endblock %}
    </main>

    <footer class="footer mt-auto p-1">
        <div class="container">
            <span class="fw-bold"> Liquimet Italia {{ 'now'|date('Y')}}&copy; </span> <span> Tutti i diritti riservati. </span>
        </div>
    </footer>

    {% block scripts %}
        {# Conditionally include jQuery if required + jQuery Validation and jQuery Additional Methods #}
        {% block jquery %}{% endblock %}

        {# Bootstrap JS bundle #}
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" 
                integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" 
                crossorigin="anonymous">
        </script>

        {# Conditionally include Bootstrap Datepicker if required #}
        {% block datepicker %}{% endblock %}

        {# Conditionally include DataTables if required #}
        {% block datatables %}{% endblock %}

        {# Conditionally include other scripts #}
        {% block page_script %}{% endblock %}

        {# This ensures main.js is the last #}
        <script src="/js/main.js"></script> 
    {% endblock %}
</body>
{% endblock %}
</html>