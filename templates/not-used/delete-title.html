<div class="modal fade" id="deleteTitle" tabindex="-1" role="dialog" aria-labelledby="title-delete" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header row">
                <h5 class="modal-title mx-auto my-auto" id="title-delete">
                    <i class="bi bi-trash my-auto"></i> 
                        RIMUOVI 
                    <i class="bi bi-trash my-auto"></i>
                </h5>
            </div> 
            
            <div class="modal-body">
                <form id="delete-title" action="{{ doc_root }}admin/title-delete" method="POST">
                    <input type="hidden" name="id_title" id="id_title" value="{{ t.id_title }}" />

                    <div class="container delete-msg">
                        Rimuovere il ruolo aziendale <br>
                            <span> 
                                {{ t.name|upper }} ({{ t.acronym|upper}})?
                            </span>
                    </div>

                    <!-- error messages -->
                    <div class="container mx-auto alert msg-box" style="display: none">
                        <span class="success"></span>
                        <span class="failed"></span>
                    </div>
                    <!-- end -->
            
                    <div class="modal-footer mx-auto">
                        <button type="button" class="btn btn-default mx-auto modal-cancel exit" data-bs-dismiss="modal">
                            <span class="bi bi-x-circle">
                                ESCI
                            </span>  
                        </button>

                        <button type="submit" class="btn btn-default mx-auto modal-save" id="delete" name="submit">
                            <span class="bi bi-check-circle">
                                CONFERMA
                            </span> 
                        </button>
                    </div>
                </form>
			</div>
        </div>
    </div>
</div>

{% block jsScript %}    
<script>
$(document).ready(function(){    
    /*$("#delete").on('click', function(){
        var id = $('#myModal').data('id');
        $('#' + id).parents("tr").remove();
        $('#myModal').modal('hide');
  });
*/




  $('form#delete-title').on('submit', function(e){
        e.preventDefault();                                                         //prevent form submission

        var id = $("#id_title").val();
        var action = $(this).attr('action');
        var form = $(this).serialize();

            $.ajax({
                type: 'POST',
                url: 'title-delete/'+id,
                data: form,
                dataType: 'json',
                //cache: false,
                success: function(output){
                    if(output.status == 1){
                        $(".delete-msg, #delete").css('display', 'none');
                        $(".exit span").text('ESCI');
                        
                        $(".msg-box")
                            .css('display', 'block')
                            .removeClass('alert-danger')
                            .addClass('alert-success');
                        $(".success").text(output.success);

                        setTimeout(function(){ 
                            $("#deleteTitle-"+id).modal({show:false});
                        }, 3000);

                        
                    //$('[data-id='+id+']').parents('tr').remove();
                        //$("#deleteTitle-"+id).modal('hide');
                        //parent.location.reload();
                        /*$(".exit").on('click', function(){
                            $("#delete-title")[0].reset();
                            $(".modal").data('id').modal('hide');
                        });*/
                    } else{
                        $(".delete-msg").css('display', 'none');
                        
                        $(".msg-box")
                            .css('display', 'block')
                            .removeClass('alert-success')
                            .addClass('alert-danger');
                        $(".failed").text(output.failed);
                    }
                    //$("#delete-title").submit();
                    /*if(output.status == 1){
                        /*$(".delete-msg")
                            .html('Il ruolo aziendale cancellato con successo!');*/
                        //$("#delete").on('click', function(){
                            //$('.deleteBtn[data-id='+id+']').closest('tr').remove();
                            //$("#deleteTitle-"+id).modal('hide');
                            //parent.location.reload();
                        //})
                        //$("#deleteTitle-"+id).modal('hide');
                        //$('.deleteBtn[data-id="'+id+'"]').closest('tr').css('background','rgb(248, 215, 218)');
                        
                        //$("#deleteTitle-"+id).close();
                        //exit();
                        /*$("#delete-title #delete").on('submit', function(){
                            $("#deleteTitle-"+id).modal('hide');
                            parent.location.reload();
                        });
                    } else{ 
                        alert('Si e verificato un problema. Riprovare.');
                    }*/
                   
                    console.log(output);
                }
            });
  });
});
</script>
{% endblock %}