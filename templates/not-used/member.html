{% extends 'admin/layout.html' %}
{% block title %} Registrazione utenti {% endblock %}

{% block content %}
    <section class="grid-container my-auto mx-auto d-flex justify-content-center">
        <form id="signup" action="{{ doc_root }}admin/member/{{ member.id_user }}" method="POST">

                            <!--    ===>    PROGRESS BAR    <===    -->
            <div class="container mb-2 pb-2" style="max-width: 45rem">
                <div class="progress">
                    <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100"
                        style="background: rgb(238,9,121); background: radial-gradient(circle, rgba(238,9,121,1) 35%, rgba(227,103,163,1) 100%)">
                    </div>
                </div>
            </div>
                            <!--    ===>    END PROGRESS BAR    <===    -->
                                        
                            <!--    ===>    FIELDSET 1    <===    -->
            <fieldset>
                <div class="form-card pt-0">
                    <div class="form-title row mt-2 pt-0 mx-auto">
                        <h2 class="fs-title"> 
                            <i class="bi bi-people"></i>
                                &nbsp;Modifica profilo&nbsp; 
                            <i class="bi bi-people"></i> 
                        </h2>
                                    
                        <h3 class="fs-subtitle pt-0 mt-0"> 
                            Modifica i dati dell'utente scelto. 
                        </h3>
                    </div>
            
                    <div class="form-group row mx-auto my-2 px-3 py-0">                 
                        <div class="col-lg-5">
                            <label for="name" class="form-control-label mb-0"> Nome </label>
                            <input type="text" class="form-control" name="name" value="{{ member.name|title }}"/>
                        </div>
                                               
                        <div class="col-lg-5">
                            <label for="surname" class="form-control-label mb-0"> Cognome </label>
                            <input type="text" class="form-control" name="surname" value="{{ member.surname|title }}"/>
                        </div>
                                                
                        <div class="col-lg-5">
                            <label for="email" class="form-control-label mb-0"> Indirizzo e-mail </label>
                            <input type="text" class="form-control" name="email" value="{{ member.email }}"/>
                        </div>
                                            
                        <div class="col-lg-5">
                            <label for="username" class="form-control-label mb-0"> Username </label>
                            <input type="text" class="form-control" name="username" value="{{ member.username|lower }}"/>
                        </div>
                        
                        <div class="col-lg-5">
                            <label class="form-control-label mb-0" for="gender"> Sesso </label>
                                <select class="form-control" name="gender" id="gender"> 
                                    <option class="opt-type"></option>   
                                    
                                    {% for g in gender %}
                                        <option value="{{ g.id_gender }}" class="opt-type" 
                                        {% if (member.id_gender == g.id_gender) %} selected {% endif %}> 
                                            {{ g.name|capitalize }} ({{ g.abbr|upper }})
                                        </option>
                                    {% endfor %}
                                </select>
                        </div> 
                        
                        <div class="col-lg-5">
                            <label for="bday" class="form-control-label mb-0"> Data di nascita </label>
                            <input type="text" class="form-control date" name="bday" value="{{ member.birthday|date('d-m-Y') }}" />
                        </div>
                                                
                        <div class="col-lg-5">
                            <label for="city" class="form-control-label mb-0"> Citta di nascita </label>
                            <input type="text" class="form-control" name="city" value="{{ member.city|capitalize }}" />
                        </div>
                                            
                        <div class="col-lg-5"> 
                            <label for="country" class="form-control-label mb-0"> Stato di nascita </label>
                            <input type="text" class="form-control" name="country" value="{{ member.country|capitalize }}"/>
                        </div>
                    </div>    
                </div>
                
                <button type="button" name="back" class="reset action-button mb-3 mt-1" style="position: absolute; left: 4rem" onclick="history.back();"> Esci </button>                    
                <button type="reset" name="reset" class="reset action-button mb-3 mt-1 mx-auto" value="reset"> Cancella </button>
                <button type="button" name="next" class="next action-button mb-3 mt-1" style="position: absolute; right: 4rem"> Avanti </button>
            </fieldset>
                            <!--    ===>    END FIELDSET 1    <===    -->
            
                            <!--    ===>    FIELDSET 2    <===    -->
            <fieldset>
                <div class="form-card pt-0">
                    <div class="form-title row mt-2 pt-0 mx-auto">
                        <h2 class="fs-title"> 
                            <i class="bi bi-people"></i>
                                &nbsp;Modifica profilo&nbsp; 
                            <i class="bi bi-people"></i> 
                        </h2>
                                    
                        <h3 class="fs-subtitle pt-0 mt-0"> 
                            Modifica i dati dell'utente scelto. 
                        </h3>
                    </div>
                                    
                    <div class="form-group row mx-auto my-auto px-3 py-2"> 
                        <div class="col-lg-5">
                            <label class="form-control-label mb-0" for="title"> Ruolo aziendale </label>
                                <select class="form-control" name="title" id="titles">
                                    <option value="" class="opt-type"></option>

                                    {% for t in titles %}
                                        <option value="{{ t.id_title }}" class="opt-type" 
                                        {% if (member.id_title == t.id_title) %} selected {% endif %}> 
                                            {{ t.name|title }} 
                                        </option>
                                    {% endfor %}
                                </select>
                        </div> 
                        
                        <div class="col-lg-5">
                            <label class="form-control-label mb-0" for="role"> Accesso </label>
                                <select class="form-control" name="role" id="roles">
                                    <option value="" class="opt-type"></option>
                                    
                                    {% for r in roles %}
                                        <option value="{{ r.id_role }}" class="opt-type" 
                                        {% if (member.id_role == r.id_role) %} selected {% endif %}> 
                                            {{ r.name|capitalize }} 
                                        </option>
                                    {% endfor %}
                                </select>
                        </div>
                    </div>          
                </div>
            
                <button type="button" name="previous" class="previous action-button mb-3 mt-1" style="position: absolute; left: 4rem"> Indietro </button>
                <button type="reset" name="reset" class="reset action-button mb-3 mt-1 mx-auto" id="reset"> Cancella </button>
                <button type="submit" name="submit" class="submit action-button mb-3 mt-1" style="position: absolute; right: 4rem"> Salva </button>
            </fieldset>
                            <!--    ===>    END FIELDSET 2    <===    -->
        </form>
    </section>
{% endblock %}

{% block jsScript %}    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">      <!-- Bootstrap 5 CSS -->
<link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/vanillajs-datepicker@1.1.4/dist/css/datepicker.min.css'>              <!-- Vanilla Datepicker CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vanillajs-datepicker@1.3.4/dist/css/datepicker-bs5.min.css">          <!-- Vanilla Datepicker CSS -->
<script src="https://cdn.jsdelivr.net/npm/vanillajs-datepicker@1.3.4/dist/js/datepicker.min.js"></script>
    
<script>
    $(document).ready(function(){
//  ===> MULTI-STEP FIELDSET CHANGE   
        var current = 1, current_step, next_step, steps;
        steps = $("fieldset").length;

        //next fieldset in multi-step form
        $(".next").click(function(){
            current_step = $(this).closest("fieldset");  
            next_step = $(this).closest("fieldset").next();
                    
            next_step.show();
            current_step.hide();
            setProgressBar(++current);
        });

        //previous fieldset in multi-step form
        $(".previous").click(function(){
            current_step = $(this).closest("fieldset");
            previous_step = $(this).closest("fieldset").prev();
            current = 2;

            previous_step.show();
            current_step.hide();
            setProgressBar(--current);
        });
    
        //setting progress bar to % of current fieldset
        setProgressBar(current);
        
        //change progress bar action
        function setProgressBar(current){
            var percent = parseFloat(100 / steps) * current;
            percent = percent.toFixed();
                
            $(".progress-bar")
                .css("width",percent+"%")
                .html(percent+"%");     
        }   
//  ===> END MULTI-STEP FIELDSET CHANGE     
        
//  ===> RESET BUTTON     
        $(".reset").click(function(){
            $("#gender").val('');
            $("#roles").val('');
            $("#titles").val('');
        });
//  ===> END RESET BUTTON 
        
//  ===> DATEPICKER     
        //use datepicker on the date inputs
        $(".date").datepicker({
            format: 'dd-mm-yyyy',
            autoclose: true,
            language: 'it-IT',
        });
//  ===> END DATEPICKER   
    });     
</script>   
        
<!--      BOOTSTRAP DATEPICKER      -->   
<script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/js/bootstrap-datepicker.min.js" integrity="sha512-LsnSViqQyaXpD4mBBdRYeP6sRwJiJveh2ZIbW41EBrNmKxgr/LFZIiWT6yr+nycvhvauz8c2nYMhrP80YhG7Cw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/js/bootstrap-datepicker.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/locales/bootstrap-datepicker.it.min.js" charset="UTF-8"></script>
{% endblock %}

