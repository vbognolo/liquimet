{% extends 'layout.html' %}
{% block title %} Piattaforma {{ 'now'|date('Y') }} {% endblock %}

{% block content %} 
<main id="main" class="main">
        <!-- MultiStep Form -->
<div class="row d-flex justify-content-center mb-5">
    <div class="col-md-10 col-md-offset-2">
        <form id="msform">

            <!-- progressbar -->
            <ul id="progressbar">
                <li class="active" style="font-size: 9px">Trasporto</li>
                <li>Quantita</li>
                <li>Parziali</li>
            </ul>

            <!-- fieldsets -->
            <fieldset>
                <h2 class="fs-title"> <i class="bi bi-truck-front"></i> Trasporto <i class="bi bi-truck-front"></i> </h2>
                    <h3 class="fs-subtitle"> Inserire i dati richiesti </h3>
                    
                    

                        <label for="slot" class="form-label m-2 p-1"> Slot ID <br>
                             <input type="text" class="form-control" name="slot" value="{{ transport.slot }}"/>
                        </label>
                        
                        <label for="cmr" class="form-label m-2 p-1"> Numero CMR <br>
                            <input type="text" class="form-control" name="cmr" value="{{ transport.cmr }}"/>
                        </label>
                        
                        <label for="issuer" class="form-label m-2 p-1"> Ditta emittente <br>
                            <input type="text" class="form-control" name="issuer" value="{{ transport.issuer }}"/>
                        </label>

                        
                        
                        <label for="supplier" class="form-label m-2 p-1"> Fornitore <br>
                            <input type="text" class="form-control" name="supplier" value="{{ transport.supplier }}"/>
                        </label>
                        
                        <br>
                        
                        <label for="date_load" class="form-label m-2 p-1"> Data carico <br>
                            <input type="text" class="datepicker_input form-control" name="date_load" value="{{ transport.date_load }}"/>
                        </label>
                        
                        <label for="date_unload" class="form-label m-2 p-1"> Data scarico <br>
                            <input type="text" class="datepicker_input form-control" name="date_unload" value="{{ transport.date_unload }}"/>
                        </label>

                        
                        
                        <label for="transport" class="form-label m-2 p-1"> Trasporto <br>
                            <input type="text" class="form-control" name="transport" value="{{ transport.transport }}"/>
                        </label>
                        
                        <label for="container" class="form-label m-2 p-1"> Container <br>
                            <input type="text" class="form-control" name="container" value="{{ transport.container }}"/>
                        </label>
                        
                        <br>

                        <label for="note" class="form-label m-2 p-1"> Nota <br>
                            <textarea rows="1" cols="76" maxlength="200" class="form-control" name="note" value="{{ transport.note }}"></textarea>
                        </label>
                        
                        <br>
                            <input type="reset" name="reset" class="action-button" style="background-color: #ee0979" value="Cancella"/> 
                            <input type="button" name="next" class="next action-button" style="background-color: #71b471" value="Next"/>
                            <input type="button" name="data[password]" class="next btn btn-primary btn-block" value="Travel Details" />
            </fieldset>

            <fieldset>
                <h2 class="fs-title"> <i class="bi bi-truck-flatbed"></i> ... Quantità ... <i class="bi bi-truck"></i> </h2>
                    <h3 class="fs-subtitle"> Inserire le quantità del nuovo trasporto </h3>
                   
                        <label for="kg_load" class="form-label m-2 p-1"> Quantità nominale caricata [kg] <br>
                            <input type="text" class="form-control" name="kg_load" value="{{ quantity.kg_load }}"/>
                        </label>
                    
                        <label for="cooling" class="form-label m-2 p-1"> Raffreddamento <br>
                            <input type="text" class="form-control" name="cooling" value="{{ quantity.cooling }}"/>
                        </label>    <!-- if yes = 600 else no = 0 -->
                    
                        <label for="price_typology" class="form-label m-2 p-1"> Tipologia costo extra <br>
                            <input type="text" class="form-control" name="price_typology" value="{{ quantity.price_typology }}"/>
                        </label>    <!-- yes/no question, if yes display price value -->

                        <br>

                        <label for="price_value" class="form-label m-2 p-1"> Valore costo extra <br>
                            <input type="text" class="form-control" name="price_value" value="{{ quantity.price_value }}"/>
                        </label>
                    
                        <label for="kg_unload" class="form-label m-2 p-1"> Quantità scaricata PD [kg] <br>
                            <input type="text" class="form-control" name="kg_unload" value="{{ quantity.kg_unload }}"/>
                        </label>
                    
                        <label for="liquid_density" class="form-label m-2 p-1"> Densità (liquido) [<sup>kg</sup>&frasl;<sub>m<sup>3</sup></sub>] <br>
                            <input type="text" class="form-control" name="liquid_density" value="{{ quantity.liquid_density }}"/>
                        </label>

                        <br>
                    
                        <label for="gas_weight" class="form-label m-2 p-1"> Peso specifico (gas) <big>[</big><sup>kg</sup>&frasl;<sub>Nm<sup>3</sup></sub><big>]</big> <br>
                            <input type="text" class="form-control" name="gas_weight" value="{{ quantity.gas_weight }}"/>
                        </label>

                        <label for="pcs_ghv" class="form-label m-2 p-1"> PCS/GHV <big>[</big><sup>kWh</sup>&frasl;<sub>kg</sub><big>]</big> <br>
                            <input type="text" class="form-control" name="pcs_ghv" value="{{ quantity.pcs_ghv }}"></textarea>
                        </label>
                    
                        <br>
                            <input type="button" name="previous" class="previous action-button-previous" style="background-color: #0066cc" value="Previous"/>
                            <input type="reset" name="reset" class="action-button" style="background-color: #ee0979" value="Cancella"/> 
                            <input type="button" name="next" class="next action-button" style="background-color: #71b471" value="Next"/>
            </fieldset>

            <fieldset>
                <h2 class="fs-title"> <i class="bi bi-fuel-pump"></i> PARZIALI <i class="bi bi-fuel-pump"></i> </h2>
                    <h3 class="fs-subtitle"> Inserire i scaricamenti parziali del nuovo trasporto </h3>
                
                    <label for="kg_load" class="form-label m-2 p-1"> Quantità nominale caricata [kg] <br>
                        <input type="text" class="form-control" name="kg_load" value="{{ quantity.kg_load }}"/>
                    </label>

                    <br>
                   
                    <label for="cooling" class="form-label m-1 p-1"> Raffreddamento <br>
                        <input type="text" class="form-control" name="cooling" value="{{ quantity.cooling }}"/>
                    </label>    <!-- if yes = 600 else no = 0 -->
                   
                    <label for="price_typology" class="form-label m-1 p-1"> Tipologia costo extra <br>
                        <input type="text" class="form-control" name="price_typology" value="{{ quantity.price_typology }}"/>
                    </label>    <!-- yes/no question, if yes display price value -->

                    <br>

                    <label for="price_value" class="form-label m-1 p-1"> Valore costo extra <br>
                        <input type="text" class="form-control" name="price_value" value="{{ quantity.price_value }}"/>
                    </label>
                   
                    <label for="kg_unload" class="form-label m-1 p-1"> Quantità scaricata PD [kg] <br>
                        <input type="text" class="form-control" name="kg_unload" value="{{ quantity.kg_unload }}"/>
                    </label>

                    <br>
                   
                    <label for="liquid_density" class="form-label m-1 p-1"> Densità (liquido) [<sup>kg</sup>&frasl;<sub>m<sup>3</sup></sub>] <br>
                        <input type="text" class="form-control" name="liquid_density" value="{{ quantity.liquid_density }}"/>
                    </label>
                   
                    <label for="gas_weight" class="form-label m-1 p-1"> Peso specifico (gas) <big>[</big><sup>kg</sup>&frasl;<sub>Nm<sup>3</sup></sub><big>]</big> <br>
                        <input type="text" class="form-control" name="gas_weight" value="{{ quantity.gas_weight }}"/>
                    </label>
                   
                    <br>

                    <label for="pcs_ghv" class="form-label m-1 p-1"> PCS/GHV <big>[</big><sup>kWh</sup>&frasl;<sub>kg</sub><big>]</big> <br>
                        <input type="text" class="form-control" name="pcs_ghv" value="{{ quantity.pcs_ghv }}"></textarea>
                    </label>
                   
                    <br>
                        <input type="button" name="previous" class="previous action-button-previous" style="background-color: #0066cc" value="Previous"/>
                        <input type="reset" name="reset" class="action-button" style="background-color: #ee0979" value="Cancella"/> 
                        <input type="submit" name="submit" class="submit action-button" style="background-color: #71b471" value="Submit"/>
            </fieldset>
        </form>
    </div>
</div>
<!-- /.MultiStep Form -->
</main>

                                                        <!-- scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>             <!-- Bootstrap 5 JavaScript Bundle with Popper -->
<script src='https://cdn.jsdelivr.net/npm/vanillajs-datepicker@1.1.4/dist/js/datepicker-full.min.js'></script>      <!-- Vanilla Datepicker JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>

<script>
                /* vanillajs-datepicker 1.1.4 JS */
    const getDatePickerTitle = elem => {
        const label = elem.nextElementSibling;                      // from the label or the aria-label
        let titleText = '';
  
            if(label && label.tagName === 'label'){
                titleText = label.textContent;
            } else{
                titleText = elem.getAttribute('aria-label') || '';
            }
        
        return titleText;
    }

    const elems = document.querySelectorAll('.datepicker_input');
    
        for(const elem of elems){
            const datepicker = new Datepicker(elem, {
                'format': 'dd-mm-yyyy',
                title: getDatePickerTitle(elem)
            });
        }      




    
//jQuery time
var current_fs, next_fs, previous_fs; //fieldsets
var left, opacity, scale; //fieldset properties which we will animate
var animating; //flag to prevent quick multi-click glitches

$(".next").click(function(){
	if(animating) return false;
	animating = true;
	
	current_fs = $(this).parent();
	next_fs = $(this).parent().next();
	
	//activate next step on progressbar using the index of next_fs
	$("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");
	
	//show the next fieldset
	next_fs.show(); 
	//hide the current fieldset with style
	current_fs.animate({opacity: 0}, {
		step: function(now, mx) {
			//as the opacity of current_fs reduces to 0 - stored in "now"
			//1. scale current_fs down to 80%
			scale = 1 - (1 - now) * 0.8;
			//2. bring next_fs from the right(50%)
			left = (now * 50)+"%";
			//3. increase opacity of next_fs to 1 as it moves in
			opacity = 1 - now;
			current_fs.css({
        'transform': 'scale('+scale+')',
        'position': 'absolute'
      });
			next_fs.css({'left': left, 'opacity': opacity});
		}, 
		duration: 800, 
		complete: function(){
			current_fs.hide();
			animating = false;
		}, 
		//this comes from the custom easing plugin
		easing: 'easeInOutBack'
	});
});

$(".previous").click(function(){
	if(animating) return false;
	animating = true;
	
	current_fs = $(this).parent();
	previous_fs = $(this).parent().prev();
	
	//de-activate current step on progressbar
	$("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");
	
	//show the previous fieldset
	previous_fs.show(); 
	//hide the current fieldset with style
	current_fs.animate({opacity: 0}, {
		step: function(now, mx) {
			//as the opacity of current_fs reduces to 0 - stored in "now"
			//1. scale previous_fs from 80% to 100%
			scale = 0.8 + (1 - now) * 0.2;
			//2. take current_fs to the right(50%) - from 0%
			left = ((1 - now) * 50)+"%";
			//3. increase opacity of previous_fs to 1 as it moves in
			opacity = 1 - now;
			current_fs.css({'left': left});
			previous_fs.css({
                'transform': 'scale('+scale+')', 
                'opacity': opacity
            });
		}, 
		duration: 800, 
		complete: function(){
			current_fs.hide();
			animating = false;
		}, 
		//this comes from the custom easing plugin
		easing: 'easeInOutBack'
	});
});

$(".submit").click(function(){
	return false;
})
</script>
{% endblock %}