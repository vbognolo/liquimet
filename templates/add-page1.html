{% extends 'layout.html' %}
{% block title %} Piattaforma {{ 'now'|date('Y') }} {% endblock %}

{% block head %}
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link href="{{ doc_root }}css/styles.css" type="text/css" rel="stylesheet">
            
    <link rel="stylesheet" href='https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css'>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">

  
    <script src='https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>  
        
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400&display=swap" rel="stylesheet">
{% endblock %}

{% block content %} 
    <section class="grid-container my-auto mx-auto d-flex justify-content-center">

            <form id="msform" novalidate action="{{ doc_root }}transport-add" method="post">
            <!--    <ul id="progressbar">
                    <li class="active" id="step1">
                        <strong> Trasporto </strong>
                    </li>
                    <li id="step2">
                        <strong> Quantita </strong>
                    </li>
                    <li id="step3">
                        <strong> Parziali </strong>
                    </li>
                    <li id="step4">
                         <strong> Conferma </strong>
                    </li>
                </ul>
            -->
                <div class="container mb-2 pb-2" style="max-width: 40rem">
                    <div class="progress">
                        <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                </div>
                
                    <!-- fieldset 1 (transport) -->
                    <fieldset>
                        <div class="form-card pt-0 row">
                            <h2 class="fs-title"> <i class="bi bi-truck-front"></i> &nbsp;Trasporto&nbsp; <i class="bi bi-truck-front"></i> </h2>
                                <h3 class="fs-subtitle"> Inserire i dati richiesti per creare il nuovo trasporto. </h3>
                            
                                <div class="col-lg-4">
                                    <label class="form-control-label mb-0" for="type"> Tipo </label>
                                        <select class="form-control" name="type" id="type">
                                            <option value=""></option>
                                            <option value="0"> Trasporto pieno </option>
                                            <option value="1"> Trasporto parziale </option>
                                        </select>
                                </div>            
                                
                                <div class="col-lg-4">
                                    <label for="slot" class="form-control-label mb-0"> Slot ID </label>
                                    <input type="text" class="form-control" name="slot" value="{{ transport.slot }}"/>
                                </div>
                                    
                                <div class="col-lg-4">
                                    <label for="cmr" class="form-control-label mb-0"> Numero CMR </label>
                                    <input type="text" class="form-control" name="cmr" value="{{ transport.cmr }}"/>
                                </div>
                                    
                                <div class="col-lg-4">
                                    <label for="issuer" class="form-control-label mb-0"> Ditta emittente </label>
                                    <input type="text" class="form-control" name="issuer" value="{{ transport.issuer }}"/>
                                </div>
                                
                                <div class="col-lg-4">
                                    <label for="supplier" class="form-control-label mb-0"> Fornitore </label>
                                    <input type="text" class="form-control" name="supplier" value="{{ transport.supplier }}"/>
                                </div>
                                
                                <div class="col-lg-4">
                                    <label for="transport" class="form-control-label mb-0"> Trasporto </label>
                                    <input type="text" class="form-control" name="transport" value="{{ transport.transport }}"/>
                                </div>
                                    
                                <div class="col-lg-4">
                                    <label for="date_load" class="form-control-label mb-0" data-toggle="tooltip" title="Terminale"> Data carico </label>
                                    <input type="date" class="datepicker_input form-control" name="date_load" value="{{ transport.date_load }}"/>
                                </div>
                                    
                                <div class="col-lg-4">
                                    <label for="date_unload" class="form-control-label mb-0" data-toggle="tooltip" title="Padova"> Data scarico </label>
                                    <input type="text" class="datepicker_input form-control" name="date_unload" value="{{ transport.date_unload }}"/>
                                </div>
                                
                                <div class="col-lg-4"> 
                                    <label for="container" class="form-control-label mb-0"> Container </label>
                                    <input type="text" class="form-control" name="container" value="{{ transport.container }}"/>
                                </div>
                                    
                                <div class="col-lg-12">
                                    <label for="note" class="form-control-label mb-0"> Nota </label>
                                    <textarea rows="2" class="form-control" name="note" value="{{ transport.note }}"></textarea>
                                </div>
                        </div>
                        
                        <button type="reset" name="reset" class="action-button m-1" value="reset"> Cancella </button>
                        <button type="button" name="next" class="next action-button m-1"> Avanti </button>
                    </fieldset>
                    <!-- end fieldset 1 (transport) -->

                    <!-- fieldset 2 (quantity) -->
                    <fieldset>
                        <div class="form-card pt-0 row">
                            <h2 class="fs-title"> <i class="bi bi-truck-flatbed"></i> ... Quantità ... <i class="bi bi-truck"></i> </h2>
                                <h3 class="fs-subtitle"> Inserire le quantità del nuovo trasporto. </h3>

                                <div class="col-lg-4">
                                    <label for="kg_load" class="form-control-label mb-0" data-toggle="tooltip" title="kg"> Quantità nominale caricata </label>
                                    <input type="text" class="form-control" name="kg_load" value="{{ quantity.kg_load }}"/>
                                </div>

                                <div class="col-lg-4">
                                    <label class="form-control-label mb-0" for="cooling"> Raffreddamento </label>
                                        <select class="form-control" name="cooling" id="cooling">
                                            <option value="{{ quantity.cooling }}"></option>
                                            <option value="600"> Sì </option>
                                            <option value="0"> No </option>
                                        </select>
                                </div>  
                            
                                <div class="col-lg-4">
                                    <label class="form-control-label mb-0" for="price_typology"> Tipologia costo extra </label>
                                        <select class="form-control" name="price_typology" id="price_typology">
                                            <option value="{{ quantity.price_typology }}"></option>
                                            <option value="SI"> Sì </option>
                                            <option value="NO"> No </option>
                                        </select>
                                </div> 
                            
                                <div class="col-lg-4">
                                    <label for="price_value" class="form-control-label mb-0"> Valore costo extra </label>
                                    <input type="text" class="form-control" name="price_value" value="{{ quantity.price_value }}" disabled/>
                                </div>
                                
                                <div class="col-lg-4">
                                    <label for="kg_unload" class="form-control-label mb-0" data-toggle="tooltip" title="kg"> Quantità scaricata PD </label>
                                    <input type="text" class="form-control" name="kg_unload" value="{{ quantity.kg_unload }}"/>
                                </div>

                                <div class="col-lg-4">
                                    <label for="liquid_density" class="form-control-label mb-0" data-toggle="tooltip" title="[<sup>kg</sup>&frasl;<sub>m<sup>3</sup></sub>]"> Densità (liquido) </label>
                                    <input type="text" class="form-control" name="liquid_density" value="{{ quantity.liquid_density }}"/>
                                </div>

                                <div class="col-lg-4">
                                    <label for="gas_weight" class="form-control-label mb-0"> Peso specifico (gas)<br> <big>[</big><sup>kg</sup>&frasl;<sub>Nm<sup>3</sup></sub><big>]</big> </label>
                                    <input type="text" class="form-control" name="gas_weight" value="{{ quantity.gas_weight }}"/>
                                </div>
                                
                                <div class="col-lg-4">
                                    <label for="pcs_ghv" class="form-control-label mb-0"> PCS/GHV </label>
                                    <input type="text" class="form-control" name="pcs_ghv" value="{{ quantity.pcs_ghv }}"/>
                                </div>
                        </div>

                        <button type="button" name="previous" class="previous action-button" value="Indietro"> Indietro </button>
                        <button type="reset" name="reset" class="action-button m-1" value="Cancella"> Cancella </button>
                        <button type="button" name="next" class="next action-button m-1" value="Avanti"> Avanti </button>
                    </fieldset>
                    <!-- end fieldset 2 (quantity) -->

                    <!-- fieldset 3 (partial) -->
                    <fieldset class="row">
                        <div class="form-card pt-0 row">
                            <h2 class="fs-title"><i class="bi bi-fuel-pump"></i> &nbsp;PARZIALI&nbsp; <i class="bi bi-fuel-pump"></i></h2>
                                <h3 class="fs-subtitle"> Inserire gli scaricamenti parziali del nuovo trasporto </h3>

                                <div class="col-lg-4">
                                    <label for="kg_load" class="form-control-label mb-0" data-toggle="tooltip" title="kg"> Quantità nominale caricata </label>
                                    <input type="text" class="form-control" name="kg_load" value="{{ quantity.kg_load }}"/>
                                </div>

                                <div class="col-lg-4">
                                    <label class="form-control-label mb-0" for="cooling"> Raffreddamento </label>
                                        <select class="form-control" name="cooling" id="cooling">
                                            <option value="{{ quantity.cooling }}"></option>
                                            <option value="600"> Sì </option>
                                            <option value="0"> No </option>
                                        </select>
                                </div>  
                            
                                <div class="col-lg-4">
                                    <label class="form-control-label mb-0" for="price_typology"> Tipologia costo extra </label>
                                        <select class="form-control" name="price_typology" id="price_typology">
                                            <option value="{{ quantity.price_typology }}"></option>
                                            <option value="SI"> Sì </option>
                                            <option value="NO"> No </option>
                                        </select>
                                </div> 
                            
                                <div class="col-lg-4">
                                    <label for="price_value" class="form-control-label mb-0"> Valore costo extra </label>
                                    <input type="text" class="form-control" name="price_value" value="{{ quantity.price_value }}" disabled/>
                                </div>
                                
                                <div class="col-lg-4">
                                    <label for="kg_unload" class="form-control-label mb-0" data-toggle="tooltip" title="kg"> Quantità scaricata PD </label>
                                    <input type="text" class="form-control" name="kg_unload" value="{{ quantity.kg_unload }}"/>
                                </div>

                                <div class="col-lg-4">
                                    <label for="liquid_density" class="form-control-label mb-0" data-toggle="tooltip" title="[<sup>kg</sup>&frasl;<sub>m<sup>3</sup></sub>]"> Densità (liquido) </label>
                                    <input type="text" class="form-control" name="liquid_density" value="{{ quantity.liquid_density }}"/>
                                </div>

                                <div class="col-lg-4">
                                    <label for="gas_weight" class="form-control-label mb-0"> Peso specifico (gas)<br> <big>[</big><sup>kg</sup>&frasl;<sub>Nm<sup>3</sup></sub><big>]</big> </label>
                                    <input type="text" class="form-control" name="gas_weight" value="{{ quantity.gas_weight }}"/>
                                </div>
                                
                                <div class="col-lg-4">
                                    <label for="pcs_ghv" class="form-control-label mb-0"> PCS/GHV </label>
                                    <input type="text" class="form-control" name="pcs_ghv" value="{{ quantity.pcs_ghv }}"/>
                                </div>
                        </div>

                        <button type="button" name="previous" class="previous action-button" value="Indietro"> Indietro </button>
                        <button type="reset" name="reset" class="action-button m-1" value="Cancella"> Cancella </button>
                        <button type="button" name="next" class="next action-button m-1" value="Avanti"> Avanti </button>
                    </fieldset>
                    <!-- end fieldset 3 (partial) -->

                    <!-- fieldset 4 (confirm insert) -->
                    <fieldset class="row">
                        <h2 class="fs-title"><i class="bi bi-fuel-pump"></i> &nbsp;PARZIALI&nbsp; <i class="bi bi-fuel-pump"></i></h2>
                            <h3 class="fs-subtitle"> Inserire gli scaricamenti parziali del nuovo trasporto </h3>

                            <input type="text" name="email" placeholder="Email"/>
                            <input type="password" name="pass" placeholder="Password"/>
                            <input type="password" name="cpass" placeholder="Confirm Password"/>
                            <input type="button" name="previous" class="previous action-button-previous" value="Previous"/>
                            <input type="submit" name="submit" class="submit action-button" value="Submit"/>
                    </fieldset>
                    <!-- end fiedset 4 (confirm insert) -->
                </form>
        </div>
    </section>
{% endblock %}    

{% block script %}    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">      <!-- Bootstrap 5 CSS -->
<link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/vanillajs-datepicker@1.1.4/dist/css/datepicker.min.css'>   <!-- Vanilla Datepicker CSS -->
    
    <script>
        $(document).ready(function(){
            var current_fs, next_fs, previous_fs; //fieldsets
            var opacity;
            $(".next").click(function(){
            current_fs = $(this).parent();
            next_fs = $(this).parent().next();
            //Add Class Active
            $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");
            //show the next fieldset
            next_fs.show();
            //hide the current fieldset with style
            current_fs.animate({opacity: 0}, {
            step: function(now) {
            // for making fielset appear animation
            opacity = 1 - now;
            current_fs.css({
            'display': 'none',
            'position': 'relative'
            });
            next_fs.css({'opacity': opacity});
            },
            duration: 600
            });
            });
            $(".previous").click(function(){
            current_fs = $(this).parent();
            previous_fs = $(this).parent().prev();
            //Remove class active
            $("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");
            //show the previous fieldset
            previous_fs.show();
            //hide the current fieldset with style
            current_fs.animate({opacity: 0}, {
            step: function(now) {
            // for making fielset appear animation
            opacity = 1 - now;
            current_fs.css({
            'display': 'none',
            'position': 'relative'
            });
            previous_fs.css({'opacity': opacity});
            },
            duration: 600
            });
            });
            $('.radio-group .radio').click(function(){
            $(this).parent().find('.radio').removeClass('selected');
            $(this).addClass('selected');
            });
            $(".submit").click(function(){
            return false;
            })
            });



        $(document).ready(function(){
            var current = 1,current_step,next_step,steps;
            steps = $("fieldset").length;

                $(".next").click(function(){
                    current_step = $(this).parent();
                    
                    if(current == '2' && $('select[name="type"]:checked').val() == '0'){
                        next_step = $(this).parent().next().next();
                        ++current;
                    } else{
                        next_step = $(this).parent().next();
                    }
                    
                    next_step.show();
                    current_step.hide();
                    setProgressBar(++current);
                });

                $(".previous").click(function(){
                    current_step = $(this).parent();
                
                    if(current == '4' && $('select[name="type"]:checked').val() == '0'){
                        next_step = $(this).parent().prev().prev();
                        --current;
                    } else{
                        next_step = $(this).parent().prev();
                    }

                    next_step.show();
                    current_step.hide();
                    setProgressBar(--current);
                });
            
                setProgressBar(current);
                        // Change progress bar action
                function setProgressBar(curStep){
                    var percent = parseFloat(100 / steps) * curStep;
                    percent = percent.toFixed();
                
                    $(".progress-bar")
                        .css("width",percent+"%")
                        .html(percent+"%");		
                    }
        });

        





















        $(document).ready(function(){
            $("body").tooltip({ 
                selector: '[data-toggle = tooltip]',
                placement: 'right' 
            });
        });    
    
        

            /*  vanillajs-datepicker 1.1.4  */
        const getDatePickerTitle = elem => {
            const label = elem.nextElementSibling;                  // from the label or the aria-label
            let titleText = '';
                    
            if(label && label.tagName === 'label'){
                titleText = label.textContent;
            } else{
                titleText = elem.getAttribute('aria-label') || '';
            }
                            
            return titleText;
        }

        const elems = document.querySelectorAll('.datepicker_input');
            for(const elem of elems){
                const datepicker = new Datepicker(elem, {
                    'format': 'dd-mm-yyyy',
                    title: getDatePickerTitle(elem)
                });
            }  
    </script>
{% endblock %}